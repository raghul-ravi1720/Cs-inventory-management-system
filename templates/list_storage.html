<!DOCTYPE html>
<html>
<head>
  <title>Storage List</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="container mt-4">
  <h1>Raw Materials / Storage</h1>

  <!-- Search bar -->
  <form method="GET" action="{{ url_for('list_storage') }}" class="mb-3 row g-2">
    <div class="col-auto">
      <input type="text" class="form-control" name="q" placeholder="Search storage items" value="{{ request.args.get('q', '') }}">
    </div>
    <div class="col-auto">
      <button type="submit" class="btn btn-primary">Search</button>
    </div>
  </form>

  <a href="{{ url_for('add_storage') }}" class="btn btn-success mb-3">Add New Storage Item</a>
  <table class="table table-striped">
    <thead>
      <tr>
        <th>Name</th>
        <th>Spec</th>
        <th>Brand</th>
        <th>HSN Code</th>
        <th>Dealer</th>
        <th>Tax</th>
        <th>Current Stock</th>
        <th>Units</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody>
      {% for s in storages %}
        <tr>
          <td>{{ s.base_name }}</td>
          <td>{{ s.defined_name_with_spec }}</td>
          <td>{{ s.brand }}</td>
          <td>{{ s.hsn_code }}</td>
          <td>{{ s.dealer.name if s.dealer else 'N/A' }}</td>
          <td>{{ s.tax }}</td>
          <td>{{ s.current_stock }}</td>
          <td>{{ s.units }}</td>
          <td>
            <a href="{{ url_for('edit_storage', id=s.id) }}" class="btn btn-sm btn-warning">Edit</a>
            <form action="{{ url_for('delete_storage', id=s.id) }}" method="post" style="display:inline;">
              <button type="submit" class="btn btn-sm btn-danger" onclick="return confirm('Are you sure?')">Delete</button>
            </form>
          </td>
        </tr>
      {% else %}
        <tr><td colspan="9">No raw materials found.</td></tr>
      {% endfor %}
    </tbody>
  </table>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
